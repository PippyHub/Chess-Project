Index: src/Positions/saveTurn
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>false
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/Positions/saveTurn b/src/Positions/saveTurn
--- a/src/Positions/saveTurn	(revision 5035bca32b467a960ede4eff8c06ebc3c3a93d2b)
+++ b/src/Positions/saveTurn	(date 1689671414299)
@@ -1,1 +1,1 @@
-false
\ No newline at end of file
+true
\ No newline at end of file
Index: .idea/workspace.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<project version=\"4\">\n  <component name=\"AutoImportSettings\">\n    <option name=\"autoReloadType\" value=\"SELECTIVE\" />\n  </component>\n  <component name=\"ChangeListManager\">\n    <list default=\"true\" id=\"254dee7e-3c0f-48db-b43a-acc0fa3eeb74\" name=\"Changes\" comment=\"king cant take protected pieces\">\n      <change beforePath=\"$PROJECT_DIR$/.idea/workspace.xml\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/.idea/workspace.xml\" afterDir=\"false\" />\n      <change beforePath=\"$PROJECT_DIR$/src/Piece.java\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/src/Piece.java\" afterDir=\"false\" />\n    </list>\n    <option name=\"SHOW_DIALOG\" value=\"false\" />\n    <option name=\"HIGHLIGHT_CONFLICTS\" value=\"true\" />\n    <option name=\"HIGHLIGHT_NON_ACTIVE_CHANGELIST\" value=\"false\" />\n    <option name=\"LAST_RESOLUTION\" value=\"IGNORE\" />\n  </component>\n  <component name=\"FileTemplateManagerImpl\">\n    <option name=\"RECENT_TEMPLATES\">\n      <list>\n        <option value=\"Class\" />\n      </list>\n    </option>\n  </component>\n  <component name=\"Git.Settings\">\n    <option name=\"RECENT_GIT_ROOT_PATH\" value=\"$PROJECT_DIR$\" />\n    <option name=\"RESET_MODE\" value=\"HARD\" />\n  </component>\n  <component name=\"MarkdownSettingsMigration\">\n    <option name=\"stateVersion\" value=\"1\" />\n  </component>\n  <component name=\"ProblemsViewState\">\n    <option name=\"selectedTabId\" value=\"CurrentFile\" />\n  </component>\n  <component name=\"ProjectId\" id=\"2QdXOie2CjeoICbW0CLG0dGsUV3\" />\n  <component name=\"ProjectLevelVcsManager\" settingsEditedManually=\"true\" />\n  <component name=\"ProjectViewState\">\n    <option name=\"hideEmptyMiddlePackages\" value=\"true\" />\n    <option name=\"showLibraryContents\" value=\"true\" />\n  </component>\n  <component name=\"PropertiesComponent\"><![CDATA[{\n  \"keyToString\": {\n    \"RunOnceActivity.OpenProjectViewOnStart\": \"true\",\n    \"RunOnceActivity.ShowReadmeOnStart\": \"true\",\n    \"ToolWindowRun.ShowToolbar\": \"false\",\n    \"run.code.analysis.last.selected.profile\": \"pProject Default\"\n  }\n}]]></component>\n  <component name=\"RecentsManager\">\n    <key name=\"MoveFile.RECENT_KEYS\">\n      <recent name=\"$PROJECT_DIR$/src/Positions\" />\n      <recent name=\"$PROJECT_DIR$/src/Images\" />\n      <recent name=\"$PROJECT_DIR$/src\" />\n    </key>\n  </component>\n  <component name=\"RunManager\">\n    <configuration name=\"Main\" type=\"Application\" factoryName=\"Application\" nameIsGenerated=\"true\">\n      <option name=\"MAIN_CLASS_NAME\" value=\"Main\" />\n      <module name=\"Chess Project\" />\n      <method v=\"2\">\n        <option name=\"Make\" enabled=\"true\" />\n      </method>\n    </configuration>\n  </component>\n  <component name=\"SpellCheckerSettings\" RuntimeDictionaries=\"0\" Folders=\"0\" CustomDictionaries=\"0\" DefaultDictionary=\"application-level\" UseSingleDictionary=\"true\" transferred=\"true\" />\n  <component name=\"TaskManager\">\n    <task active=\"true\" id=\"Default\" summary=\"Default task\">\n      <changelist id=\"254dee7e-3c0f-48db-b43a-acc0fa3eeb74\" name=\"Changes\" comment=\"\" />\n      <created>1685684401255</created>\n      <option name=\"number\" value=\"Default\" />\n      <option name=\"presentableId\" value=\"Default\" />\n      <updated>1685684401255</updated>\n    </task>\n    <task id=\"LOCAL-00027\" summary=\"reformatting code\">\n      <created>1687217931912</created>\n      <option name=\"number\" value=\"00027\" />\n      <option name=\"presentableId\" value=\"LOCAL-00027\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1687217931912</updated>\n    </task>\n    <task id=\"LOCAL-00028\" summary=\"adding menu bar\">\n      <created>1687221697804</created>\n      <option name=\"number\" value=\"00028\" />\n      <option name=\"presentableId\" value=\"LOCAL-00028\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1687221697804</updated>\n    </task>\n    <task id=\"LOCAL-00029\" summary=\"fixed menu bar\">\n      <created>1687229129023</created>\n      <option name=\"number\" value=\"00029\" />\n      <option name=\"presentableId\" value=\"LOCAL-00029\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1687229129023</updated>\n    </task>\n    <task id=\"LOCAL-00030\" summary=\"deleted original Board class\">\n      <created>1687229448102</created>\n      <option name=\"number\" value=\"00030\" />\n      <option name=\"presentableId\" value=\"LOCAL-00030\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1687229448102</updated>\n    </task>\n    <task id=\"LOCAL-00031\" summary=\"starting save and load classes\">\n      <created>1687319457344</created>\n      <option name=\"number\" value=\"00031\" />\n      <option name=\"presentableId\" value=\"LOCAL-00031\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1687319457344</updated>\n    </task>\n    <task id=\"LOCAL-00032\" summary=\"changed piece taking method\">\n      <created>1687338066000</created>\n      <option name=\"number\" value=\"00032\" />\n      <option name=\"presentableId\" value=\"LOCAL-00032\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1687338066000</updated>\n    </task>\n    <task id=\"LOCAL-00033\" summary=\"king and pawn movements are correct (no en passant and no castling)\">\n      <created>1687434536889</created>\n      <option name=\"number\" value=\"00033\" />\n      <option name=\"presentableId\" value=\"LOCAL-00033\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1687434536889</updated>\n    </task>\n    <task id=\"LOCAL-00034\" summary=\"updated headers for tomorrow\">\n      <created>1687434629968</created>\n      <option name=\"number\" value=\"00034\" />\n      <option name=\"presentableId\" value=\"LOCAL-00034\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1687434629968</updated>\n    </task>\n    <task id=\"LOCAL-00035\" summary=\"rook and bishop move correctly\">\n      <created>1687476406239</created>\n      <option name=\"number\" value=\"00035\" />\n      <option name=\"presentableId\" value=\"LOCAL-00035\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1687476406239</updated>\n    </task>\n    <task id=\"LOCAL-00036\" summary=\"knight moves correctly\">\n      <created>1687477436431</created>\n      <option name=\"number\" value=\"00036\" />\n      <option name=\"presentableId\" value=\"LOCAL-00036\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1687477436431</updated>\n    </task>\n    <task id=\"LOCAL-00037\" summary=\"queen moves correctly\">\n      <created>1687477994965</created>\n      <option name=\"number\" value=\"00037\" />\n      <option name=\"presentableId\" value=\"LOCAL-00037\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1687477994965</updated>\n    </task>\n    <task id=\"LOCAL-00038\" summary=\"turns working correctly\">\n      <created>1687479307881</created>\n      <option name=\"number\" value=\"00038\" />\n      <option name=\"presentableId\" value=\"LOCAL-00038\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1687479307881</updated>\n    </task>\n    <task id=\"LOCAL-00039\" summary=\"castling working\">\n      <created>1687508744090</created>\n      <option name=\"number\" value=\"00039\" />\n      <option name=\"presentableId\" value=\"LOCAL-00039\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1687508744090</updated>\n    </task>\n    <task id=\"LOCAL-00040\" summary=\"all pieces get highlighted\">\n      <created>1687527227520</created>\n      <option name=\"number\" value=\"00040\" />\n      <option name=\"presentableId\" value=\"LOCAL-00040\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1687527227520</updated>\n    </task>\n    <task id=\"LOCAL-00041\" summary=\"pieces get highlighted on their turn\">\n      <created>1687528613518</created>\n      <option name=\"number\" value=\"00041\" />\n      <option name=\"presentableId\" value=\"LOCAL-00041\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1687528613518</updated>\n    </task>\n    <task id=\"LOCAL-00042\" summary=\"fixed castling double move\">\n      <created>1687530853336</created>\n      <option name=\"number\" value=\"00042\" />\n      <option name=\"presentableId\" value=\"LOCAL-00042\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1687530853336</updated>\n    </task>\n    <task id=\"LOCAL-00043\" summary=\"code shortening and updated headers\">\n      <created>1687772300334</created>\n      <option name=\"number\" value=\"00043\" />\n      <option name=\"presentableId\" value=\"LOCAL-00043\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1687772300334</updated>\n    </task>\n    <task id=\"LOCAL-00044\" summary=\"king check and updated headers\">\n      <created>1687922195238</created>\n      <option name=\"number\" value=\"00044\" />\n      <option name=\"presentableId\" value=\"LOCAL-00044\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1687922195238</updated>\n    </task>\n    <task id=\"LOCAL-00045\" summary=\"king check second iteration and updated headers\">\n      <created>1687987552301</created>\n      <option name=\"number\" value=\"00045\" />\n      <option name=\"presentableId\" value=\"LOCAL-00045\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1687987552301</updated>\n    </task>\n    <task id=\"LOCAL-00046\" summary=\"king check fourth iteration (progress!)\">\n      <created>1689224928387</created>\n      <option name=\"number\" value=\"00046\" />\n      <option name=\"presentableId\" value=\"LOCAL-00046\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689224928387</updated>\n    </task>\n    <task id=\"LOCAL-00047\" summary=\"king check (super slow loop)\">\n      <created>1689227571289</created>\n      <option name=\"number\" value=\"00047\" />\n      <option name=\"presentableId\" value=\"LOCAL-00047\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689227571289</updated>\n    </task>\n    <task id=\"LOCAL-00048\" summary=\"king check (another slow loop)\">\n      <created>1689230016677</created>\n      <option name=\"number\" value=\"00048\" />\n      <option name=\"presentableId\" value=\"LOCAL-00048\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689230016677</updated>\n    </task>\n    <task id=\"LOCAL-00049\" summary=\"noObstruction changed: Bresenham's line algorithm\">\n      <created>1689231879282</created>\n      <option name=\"number\" value=\"00049\" />\n      <option name=\"presentableId\" value=\"LOCAL-00049\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689231879282</updated>\n    </task>\n    <task id=\"LOCAL-00050\" summary=\"added diagonal to Bresenham's line algorithm\">\n      <created>1689232631865</created>\n      <option name=\"number\" value=\"00050\" />\n      <option name=\"presentableId\" value=\"LOCAL-00050\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689232631867</updated>\n    </task>\n    <task id=\"LOCAL-00051\" summary=\"noObstruction working\">\n      <created>1689239679673</created>\n      <option name=\"number\" value=\"00051\" />\n      <option name=\"presentableId\" value=\"LOCAL-00051\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689239679673</updated>\n    </task>\n    <task id=\"LOCAL-00052\" summary=\"noObstruction working (again)\">\n      <created>1689240974086</created>\n      <option name=\"number\" value=\"00052\" />\n      <option name=\"presentableId\" value=\"LOCAL-00052\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689240974086</updated>\n    </task>\n    <task id=\"LOCAL-00053\" summary=\"noObstruction working added err math.\">\n      <created>1689241012581</created>\n      <option name=\"number\" value=\"00053\" />\n      <option name=\"presentableId\" value=\"LOCAL-00053\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689241012582</updated>\n    </task>\n    <task id=\"LOCAL-00054\" summary=\"noObstruction changed to have more this.* code\">\n      <created>1689243435879</created>\n      <option name=\"number\" value=\"00054\" />\n      <option name=\"presentableId\" value=\"LOCAL-00054\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689243435879</updated>\n    </task>\n    <task id=\"LOCAL-00055\" summary=\"fixed kingCheck and noObstruction\">\n      <created>1689244242664</created>\n      <option name=\"number\" value=\"00055\" />\n      <option name=\"presentableId\" value=\"LOCAL-00055\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689244242664</updated>\n    </task>\n    <task id=\"LOCAL-00056\" summary=\"check works for own pieces\">\n      <created>1689308889837</created>\n      <option name=\"number\" value=\"00056\" />\n      <option name=\"presentableId\" value=\"LOCAL-00056\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689308889837</updated>\n    </task>\n    <task id=\"LOCAL-00057\" summary=\"separated check into multiple methods\">\n      <created>1689312676150</created>\n      <option name=\"number\" value=\"00057\" />\n      <option name=\"presentableId\" value=\"LOCAL-00057\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689312676150</updated>\n    </task>\n    <task id=\"LOCAL-00058\" summary=\"separated check into multiple methods\">\n      <created>1689312825465</created>\n      <option name=\"number\" value=\"00058\" />\n      <option name=\"presentableId\" value=\"LOCAL-00058\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689312825465</updated>\n    </task>\n    <task id=\"LOCAL-00059\" summary=\"can escape check\">\n      <created>1689316849748</created>\n      <option name=\"number\" value=\"00059\" />\n      <option name=\"presentableId\" value=\"LOCAL-00059\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689316849748</updated>\n    </task>\n    <task id=\"LOCAL-00060\" summary=\"adding checkmate\">\n      <created>1689318016931</created>\n      <option name=\"number\" value=\"00060\" />\n      <option name=\"presentableId\" value=\"LOCAL-00060\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689318016932</updated>\n    </task>\n    <task id=\"LOCAL-00061\" summary=\"fixed check so pieces can be taken\">\n      <created>1689319709897</created>\n      <option name=\"number\" value=\"00061\" />\n      <option name=\"presentableId\" value=\"LOCAL-00061\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689319709897</updated>\n    </task>\n    <task id=\"LOCAL-00062\" summary=\"bishop breaks game during fools mate\">\n      <created>1689320003374</created>\n      <option name=\"number\" value=\"00062\" />\n      <option name=\"presentableId\" value=\"LOCAL-00062\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689320003374</updated>\n    </task>\n    <task id=\"LOCAL-00063\" summary=\"checkmate works\">\n      <created>1689419945633</created>\n      <option name=\"number\" value=\"00063\" />\n      <option name=\"presentableId\" value=\"LOCAL-00063\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689419945633</updated>\n    </task>\n    <task id=\"LOCAL-00064\" summary=\"checkmate message\">\n      <created>1689423774844</created>\n      <option name=\"number\" value=\"00064\" />\n      <option name=\"presentableId\" value=\"LOCAL-00064\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689423774844</updated>\n    </task>\n    <task id=\"LOCAL-00065\" summary=\"cant take non attacking piece in check\">\n      <created>1689432126155</created>\n      <option name=\"number\" value=\"00065\" />\n      <option name=\"presentableId\" value=\"LOCAL-00065\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689432126155</updated>\n    </task>\n    <task id=\"LOCAL-00066\" summary=\"added en passant\">\n      <created>1689438968472</created>\n      <option name=\"number\" value=\"00066\" />\n      <option name=\"presentableId\" value=\"LOCAL-00066\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689438968472</updated>\n    </task>\n    <task id=\"LOCAL-00067\" summary=\"updated headers\">\n      <created>1689440458490</created>\n      <option name=\"number\" value=\"00067\" />\n      <option name=\"presentableId\" value=\"LOCAL-00067\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689440458490</updated>\n    </task>\n    <task id=\"LOCAL-00068\" summary=\"load pieces from text file\">\n      <created>1689481303454</created>\n      <option name=\"number\" value=\"00068\" />\n      <option name=\"presentableId\" value=\"LOCAL-00068\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689481303454</updated>\n    </task>\n    <task id=\"LOCAL-00069\" summary=\"save pieces to text file\">\n      <created>1689482089542</created>\n      <option name=\"number\" value=\"00069\" />\n      <option name=\"presentableId\" value=\"LOCAL-00069\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689482089542</updated>\n    </task>\n    <task id=\"LOCAL-00070\" summary=\"save and load working\">\n      <created>1689483886522</created>\n      <option name=\"number\" value=\"00070\" />\n      <option name=\"presentableId\" value=\"LOCAL-00070\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689483886522</updated>\n    </task>\n    <task id=\"LOCAL-00071\" summary=\"save and load fully implemented\">\n      <created>1689489148092</created>\n      <option name=\"number\" value=\"00071\" />\n      <option name=\"presentableId\" value=\"LOCAL-00071\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689489148092</updated>\n    </task>\n    <task id=\"LOCAL-00072\" summary=\"fixed castling\">\n      <created>1689489904670</created>\n      <option name=\"number\" value=\"00072\" />\n      <option name=\"presentableId\" value=\"LOCAL-00072\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689489904670</updated>\n    </task>\n    <task id=\"LOCAL-00073\" summary=\"fixed castling and checkmate\">\n      <created>1689498317226</created>\n      <option name=\"number\" value=\"00073\" />\n      <option name=\"presentableId\" value=\"LOCAL-00073\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689498317227</updated>\n    </task>\n    <task id=\"LOCAL-00074\" summary=\"fixing king cant take protected pieces\">\n      <created>1689655436130</created>\n      <option name=\"number\" value=\"00074\" />\n      <option name=\"presentableId\" value=\"LOCAL-00074\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689655436131</updated>\n    </task>\n    <task id=\"LOCAL-00075\" summary=\"king cant take protected pieces\">\n      <created>1689656522651</created>\n      <option name=\"number\" value=\"00075\" />\n      <option name=\"presentableId\" value=\"LOCAL-00075\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689656522651</updated>\n    </task>\n    <option name=\"localTasksCounter\" value=\"76\" />\n    <servers />\n  </component>\n  <component name=\"Vcs.Log.Tabs.Properties\">\n    <option name=\"TAB_STATES\">\n      <map>\n        <entry key=\"MAIN\">\n          <value>\n            <State />\n          </value>\n        </entry>\n      </map>\n    </option>\n  </component>\n  <component name=\"VcsManagerConfiguration\">\n    <MESSAGE value=\"noObstruction working\" />\n    <MESSAGE value=\"noObstruction working (again)\" />\n    <MESSAGE value=\"noObstruction working added err math.\" />\n    <MESSAGE value=\"noObstruction changed to have more this.* code\" />\n    <MESSAGE value=\"fixed kingCheck and noObstruction\" />\n    <MESSAGE value=\"check works for own pieces\" />\n    <MESSAGE value=\"separated check into multiple methods\" />\n    <MESSAGE value=\"can escape check\" />\n    <MESSAGE value=\"adding checkmate\" />\n    <MESSAGE value=\"fixed check so pieces can be taken\" />\n    <MESSAGE value=\"bishop breaks game during fools mate\" />\n    <MESSAGE value=\"check works\" />\n    <MESSAGE value=\"checkmate works\" />\n    <MESSAGE value=\"checkmate message\" />\n    <MESSAGE value=\"cant take non attacking piece in check\" />\n    <MESSAGE value=\"added en passant\" />\n    <MESSAGE value=\"updated headers\" />\n    <MESSAGE value=\"load pieces from text file\" />\n    <MESSAGE value=\"save pieces to text file\" />\n    <MESSAGE value=\"save and load working\" />\n    <MESSAGE value=\"save and load fully implemented\" />\n    <MESSAGE value=\"fixed castling\" />\n    <MESSAGE value=\"fixed castling and checkmate\" />\n    <MESSAGE value=\"fixing king cant take protected pieces\" />\n    <MESSAGE value=\"king cant take protected pieces\" />\n    <option name=\"LAST_COMMIT_MESSAGE\" value=\"king cant take protected pieces\" />\n  </component>\n</project>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/workspace.xml b/.idea/workspace.xml
--- a/.idea/workspace.xml	(revision 5035bca32b467a960ede4eff8c06ebc3c3a93d2b)
+++ b/.idea/workspace.xml	(date 1689671632764)
@@ -4,9 +4,13 @@
     <option name="autoReloadType" value="SELECTIVE" />
   </component>
   <component name="ChangeListManager">
-    <list default="true" id="254dee7e-3c0f-48db-b43a-acc0fa3eeb74" name="Changes" comment="king cant take protected pieces">
+    <list default="true" id="254dee7e-3c0f-48db-b43a-acc0fa3eeb74" name="Changes" comment="uncommited changes">
+      <change afterPath="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Checkout_at_18_07_23,_9_02_pm_[Changes]/shelved.patch" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Checkout_at_18_07_23__9_02_pm__Changes_.xml" afterDir="false" />
       <change beforePath="$PROJECT_DIR$/.idea/workspace.xml" beforeDir="false" afterPath="$PROJECT_DIR$/.idea/workspace.xml" afterDir="false" />
       <change beforePath="$PROJECT_DIR$/src/Piece.java" beforeDir="false" afterPath="$PROJECT_DIR$/src/Piece.java" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/src/Positions/savePosition" beforeDir="false" afterPath="$PROJECT_DIR$/src/Positions/savePosition" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/src/Positions/saveTurn" beforeDir="false" afterPath="$PROJECT_DIR$/src/Positions/saveTurn" afterDir="false" />
     </list>
     <option name="SHOW_DIALOG" value="false" />
     <option name="HIGHLIGHT_CONFLICTS" value="true" />
@@ -21,6 +25,11 @@
     </option>
   </component>
   <component name="Git.Settings">
+    <option name="RECENT_BRANCH_BY_REPOSITORY">
+      <map>
+        <entry key="$PROJECT_DIR$" value="main" />
+      </map>
+    </option>
     <option name="RECENT_GIT_ROOT_PATH" value="$PROJECT_DIR$" />
     <option name="RESET_MODE" value="HARD" />
   </component>
@@ -36,14 +45,14 @@
     <option name="hideEmptyMiddlePackages" value="true" />
     <option name="showLibraryContents" value="true" />
   </component>
-  <component name="PropertiesComponent"><![CDATA[{
-  "keyToString": {
-    "RunOnceActivity.OpenProjectViewOnStart": "true",
-    "RunOnceActivity.ShowReadmeOnStart": "true",
-    "ToolWindowRun.ShowToolbar": "false",
-    "run.code.analysis.last.selected.profile": "pProject Default"
+  <component name="PropertiesComponent">{
+  &quot;keyToString&quot;: {
+    &quot;RunOnceActivity.OpenProjectViewOnStart&quot;: &quot;true&quot;,
+    &quot;RunOnceActivity.ShowReadmeOnStart&quot;: &quot;true&quot;,
+    &quot;ToolWindowRun.ShowToolbar&quot;: &quot;false&quot;,
+    &quot;run.code.analysis.last.selected.profile&quot;: &quot;pProject Default&quot;
   }
-}]]></component>
+}</component>
   <component name="RecentsManager">
     <key name="MoveFile.RECENT_KEYS">
       <recent name="$PROJECT_DIR$/src/Positions" />
@@ -69,13 +78,6 @@
       <option name="presentableId" value="Default" />
       <updated>1685684401255</updated>
     </task>
-    <task id="LOCAL-00027" summary="reformatting code">
-      <created>1687217931912</created>
-      <option name="number" value="00027" />
-      <option name="presentableId" value="LOCAL-00027" />
-      <option name="project" value="LOCAL" />
-      <updated>1687217931912</updated>
-    </task>
     <task id="LOCAL-00028" summary="adding menu bar">
       <created>1687221697804</created>
       <option name="number" value="00028" />
@@ -412,7 +414,14 @@
       <option name="project" value="LOCAL" />
       <updated>1689656522651</updated>
     </task>
-    <option name="localTasksCounter" value="76" />
+    <task id="LOCAL-00076" summary="king cant take protected pieces fixed">
+      <created>1689657348499</created>
+      <option name="number" value="00076" />
+      <option name="presentableId" value="LOCAL-00076" />
+      <option name="project" value="LOCAL" />
+      <updated>1689657348499</updated>
+    </task>
+    <option name="localTasksCounter" value="77" />
     <servers />
   </component>
   <component name="Vcs.Log.Tabs.Properties">
@@ -427,8 +436,6 @@
     </option>
   </component>
   <component name="VcsManagerConfiguration">
-    <MESSAGE value="noObstruction working" />
-    <MESSAGE value="noObstruction working (again)" />
     <MESSAGE value="noObstruction working added err math." />
     <MESSAGE value="noObstruction changed to have more this.* code" />
     <MESSAGE value="fixed kingCheck and noObstruction" />
@@ -452,6 +459,8 @@
     <MESSAGE value="fixed castling and checkmate" />
     <MESSAGE value="fixing king cant take protected pieces" />
     <MESSAGE value="king cant take protected pieces" />
-    <option name="LAST_COMMIT_MESSAGE" value="king cant take protected pieces" />
+    <MESSAGE value="king cant take protected pieces fixed" />
+    <MESSAGE value="uncommited changes" />
+    <option name="LAST_COMMIT_MESSAGE" value="uncommited changes" />
   </component>
 </project>
\ No newline at end of file
Index: src/Positions/savePosition
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>6,2,false,false,queen\n4,7,false,false,king\n0,7,false,false,rook\n7,7,false,false,rook\n2,7,false,false,bishop\n2,4,false,false,bishop\n2,5,false,false,knight\n4,6,false,false,knight\n0,6,false,false,pawn\n1,5,false,false,pawn\n2,6,false,false,pawn\n3,6,false,false,pawn\n5,6,false,false,pawn\n6,6,false,false,pawn\n7,5,false,true,pawn\n5,1,true,false,queen\n4,0,true,false,king\n0,0,true,false,rook\n7,0,true,false,rook\n2,0,true,false,bishop\n5,0,true,false,bishop\n1,0,true,false,knight\n6,0,true,false,knight\n0,2,true,false,pawn\n1,3,true,true,pawn\n2,1,true,false,pawn\n3,2,true,false,pawn\n4,1,true,false,pawn\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/Positions/savePosition b/src/Positions/savePosition
--- a/src/Positions/savePosition	(revision 5035bca32b467a960ede4eff8c06ebc3c3a93d2b)
+++ b/src/Positions/savePosition	(date 1689671414298)
@@ -1,28 +1,32 @@
-6,2,false,false,queen
-4,7,false,false,king
+7,3,false,false,queen
+6,7,false,true,king
 0,7,false,false,rook
-7,7,false,false,rook
+5,7,false,false,rook
 2,7,false,false,bishop
 2,4,false,false,bishop
 2,5,false,false,knight
-4,6,false,false,knight
-0,6,false,false,pawn
-1,5,false,false,pawn
+5,5,false,false,knight
+0,5,false,false,pawn
+1,6,false,false,pawn
 2,6,false,false,pawn
 3,6,false,false,pawn
+4,5,false,false,pawn
 5,6,false,false,pawn
 6,6,false,false,pawn
-7,5,false,true,pawn
-5,1,true,false,queen
+7,5,false,false,pawn
+3,1,true,false,queen
 4,0,true,false,king
 0,0,true,false,rook
 7,0,true,false,rook
-2,0,true,false,bishop
+1,1,true,false,bishop
 5,0,true,false,bishop
-1,0,true,false,knight
+1,0,true,true,knight
 6,0,true,false,knight
 0,2,true,false,pawn
-1,3,true,true,pawn
+1,2,true,false,pawn
 2,1,true,false,pawn
 3,2,true,false,pawn
 4,1,true,false,pawn
+5,1,true,false,pawn
+6,1,true,false,pawn
+7,1,true,false,pawn
Index: .idea/shelf/Uncommitted_changes_before_Checkout_at_18_07_23,_9_02_pm_[Changes]/shelved.patch
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/shelf/Uncommitted_changes_before_Checkout_at_18_07_23,_9_02_pm_[Changes]/shelved.patch b/.idea/shelf/Uncommitted_changes_before_Checkout_at_18_07_23,_9_02_pm_[Changes]/shelved.patch
new file mode 100644
--- /dev/null	(date 1689670972338)
+++ b/.idea/shelf/Uncommitted_changes_before_Checkout_at_18_07_23,_9_02_pm_[Changes]/shelved.patch	(date 1689670972338)
@@ -0,0 +1,218 @@
+Index: src/Positions/saveTurn
+IDEA additional info:
+Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+<+>false
+Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+<+>UTF-8
+===================================================================
+diff --git a/src/Positions/saveTurn b/src/Positions/saveTurn
+--- a/src/Positions/saveTurn	(revision f7f4a1687db3927b2782d11a4ff6fa99e39a5065)
++++ b/src/Positions/saveTurn	(date 1689669950682)
+@@ -1,1 +1,1 @@
+-false
+\ No newline at end of file
++true
+\ No newline at end of file
+Index: src/Piece.java
+IDEA additional info:
+Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+<+>/**\n * Constructor for all chess pieces\n *\n * @author (Piper Inns Hall)\n * @version (16/07/2023)\n */\nimport java.util.LinkedList;\npublic class Piece {\n    static final int SQR_SIZE = Board.SQR_SIZE;\n    int x, y, pX, pY, clickX, clickY, deltaX, deltaY; // Piece values\n    int tempPX, tempPY, tempDX, tempDY , tempCX, tempCY; // Temporary stored values\n    boolean isBlack;\n    boolean pieceMoved;\n    String name;\n    LinkedList<Piece> ps;\n    boolean castling;\n    boolean enPassantEnabled;\n    private static boolean isBlackTurn;\n    public static boolean checkmated;\n    public static boolean winner;\n    public static Piece enPassantPawn;\n    Piece castleRook;\n    Piece attacker;\n    public Piece(int pX, int pY, boolean isBlack, boolean pieceMoved, String n, LinkedList<Piece> ps) {\n        this.x = pX * SQR_SIZE;\n        this.y = pY * SQR_SIZE;\n        this.pX = pX;\n        this.pY = pY;\n        this.isBlack = isBlack;\n        this.pieceMoved = pieceMoved;\n        this.ps = ps;\n        this.name = n;\n        ps.add(this);\n    }\n    public void move(int pX, int pY) {\n        deltaX = pX - this.pX;\n        deltaY = pY - this.pY;\n        clickX = pX;\n        clickY = pY;\n        boolean checking = oppositeKingInCheck();\n        if (legalMove(true, false)) {\n            moveType();\n            this.pieceMoved = true;\n            this.pX = pX;\n            this.pY = pY;\n            this.x = pX * SQR_SIZE;\n            this.y = pY * SQR_SIZE;\n            switchTurn();\n            if (checking) checkmate(checkmated(), this.isBlack);\n        }\n    }\n\n    public static void switchTurn() { isBlackTurn = !isBlackTurn; } // Switching turns\n    public static void resetTurn() { isBlackTurn = false; } // Reset turns\n    public static void loadTurn(boolean blackTurn) { isBlackTurn = blackTurn; } // Loads turns\n    public static boolean saveTurn() { return isBlackTurn; } // Saves turns\n    public void moveType() {\n        pieceTake();\n        pawnPromote();\n        pawnDouble();\n        if (this.castling) castle();\n    }\n    public void pieceTake() {\n        Piece take = Board.getPiece(clickX * SQR_SIZE, clickY * SQR_SIZE);\n        if (take != null) take.kill(); // Taking pieces\n    }\n    public void kill() {\n        if (enPassantPawn == this) enPassantPawn = null; // Reset en passant pawn if it is killed\n        ps.remove(this);\n    }\n    public void pawnPromote() {\n        if (name.equalsIgnoreCase(\"pawn\"))\n            if ((this.isBlack && clickY == 7) || (!this.isBlack && clickY == 0)) name = \"queen\"; // Promoting pawns\n    }\n    public void pawnDouble() {\n        enPassantPawn = null;\n        if (name.equalsIgnoreCase(\"pawn\") && Math.abs(deltaY) == 2) {\n            enPassantEnabled = true;\n            enPassantPawn = this;\n        }\n    }\n    public void castle() {\n        castleRook.pX = (deltaX > 0) ? this.pX + 1 : this.pX - 1;\n        castleRook.x = castleRook.pX * SQR_SIZE;\n        castleRook.y = castleRook.pY * SQR_SIZE;\n        castling = false;\n    }\n    public boolean legalMove(boolean realMove, boolean resolveCheck) {\n        if (realMove && !checkTurn()) return false;\n        if (ownSQRMove()) return false;\n        if (!resolveCheck && ownPieceMove()) return false;\n        if (!queenMove()) return false;\n        if (!kingMove()) return false;\n        if (realMove && !resolveCheck()) return false;\n        if (!rookMove()) return false;\n        if (!knightMove()) return false;\n        if (!bishopMove()) return false;\n        if (!pawnMove()) return false;\n        if (!boardBoundary()) return false;\n        return noObstruction();\n    }\n    public boolean checkTurn() { return (isBlackTurn && this.isBlack) || (!isBlackTurn && !this.isBlack); }\n    public boolean ownSQRMove() { return this.deltaX == 0 && this.deltaY == 0; } // Cannot move to own SQR\n    public boolean ownPieceMove() {\n        Piece clickedPiece = Board.getPiece(clickX * SQR_SIZE, clickY * SQR_SIZE);\n        return clickedPiece != null && clickedPiece.isBlack == isBlack; // Cannot take own pieces\n    }\n    public boolean queenMove() {\n        if (!name.equalsIgnoreCase(\"queen\")) return true;\n        return Math.abs(this.deltaX) == Math.abs(this.deltaY) || deltaX == 0 || deltaY == 0;\n    } // Queen moves\n    public boolean kingMove() {\n        if (!name.equalsIgnoreCase(\"king\")) return true;\n        if (!pieceMoved && deltaY == 0 && Math.abs(deltaX) == 2) {\n            int rookX = (deltaX > 0) ? 7 : 0; // Determine the rook's starting position\n            int rookY = pY; // Rook stays in the same row\n            castleRook = Board.getPiece(rookX * SQR_SIZE, rookY * SQR_SIZE);\n            Piece bFile = Board.getPiece(SQR_SIZE, pY * SQR_SIZE);\n            boolean bFilePiece = (bFile != null && deltaX < 0);\n            if (castleRook != null && castleRook.name.equalsIgnoreCase(\"rook\") && !castleRook.pieceMoved\n                    && !bFilePiece) {\n                castling = true;\n                return true; // Castling successful\n            }\n            return false; // Castling is not valid\n        }\n        return Math.abs(deltaX) <= 1 && Math.abs(deltaY) <= 1; // King moves\n    }\n    public boolean resolveCheck() {\n        this.tempSave();\n        //Board.selectedPiece.pX = clickX;\n        //Board.selectedPiece.pY = clickY;\n        boolean kingInCheck = Board.selectedPiece.myKingInCheck();\n        Piece attack = attacker;\n        Piece attackedPiece = Board.getPiece(clickX * SQR_SIZE, clickY * SQR_SIZE);\n        boolean attackClicked = (attack == attackedPiece);\n\n\n        if (kingInCheck) {\n\n            if (Board.selectedPiece.name.equalsIgnoreCase(\"king\") && isPieceProtected(attacker) &&\n                    attackClicked) {\n                this.tempLoad();\n                return false; // King cannot take protected piece\n            }\n            else if (!Board.selectedPiece.name.equalsIgnoreCase(\"king\") && !attackClicked) {\n                this.tempLoad();\n                return false; // King cannot escape check\n            }\n        }\n        this.tempLoad();\n        return true; // King can escape check with this move\n    }\n    public boolean myKingInCheck() {\n        Piece myKing = myKingPos();\n        return check(myKing, myKing.pX, myKing.pY);\n    }\n    public boolean oppositeKingInCheck() {\n        Piece oppositeKing = oppositeKingPos();\n        return checking(oppositeKing, oppositeKing.pX, oppositeKing.pY);\n    }\n    public Piece myKingPos() {\n        for (Piece p : ps) {\n            if (p.name.equalsIgnoreCase(\"king\") && p.isBlack == this.isBlack) {\n                return p;\n            }\n        }\n        return null; // Return null if the king is not found\n    }\n    public Piece oppositeKingPos() {\n        for (Piece p : ps) {\n            if (p.name.equalsIgnoreCase(\"king\") && p.isBlack != this.isBlack) {\n                return p;\n            }\n        }\n        return null; // Return null if the king is not found\n    }\n    private boolean isPieceProtected(Piece attacker) {\n        for (Piece p : ps) {\n            if (p.isBlack != isBlackTurn) {\n                p.tempSave();\n                p.deltaX = attacker.pX - p.pX;\n                p.deltaY = attacker.pY - p.pY;\n                p.clickX = attacker.pX;\n                p.clickY = attacker.pY;\n                if (p.legalMove(false, true)) {\n                    p.tempLoad();\n                    return true; // Piece is protected\n                }\n                p.tempLoad();\n            }\n        }\n        return false; // Piece is not protected\n    }\n    public boolean check(Piece myKing, int kingPosX, int kingPosY) {\n        for (Piece p : ps) {\n            if (p.isBlack != isBlackTurn) {\n                p.tempSave();\n                if (myKing != null) {\n                    p.deltaX = kingPosX - p.pX;\n                    p.deltaY = kingPosY - p.pY;\n                    p.clickX = kingPosX;\n                    p.clickY = kingPosY;\n                }\n                if (p.legalMove(false, false)) {\n                    attacker = p;\n                    p.tempLoad();\n                    return true;\n                }\n                p.tempLoad();\n            }\n        }\n        return false;\n    }\n    public boolean checking(Piece oppositeKing, int kingPosX, int kingPosY) {\n        for (Piece p : ps) {\n            if (p.isBlack == isBlackTurn) {\n                p.tempSave();\n                if (p == Board.selectedPiece) {\n                    p.pX = Board.selectedPiece.clickX;\n                    p.pY = Board.selectedPiece.clickY;\n                }\n                if (oppositeKing != null) {\n                    p.deltaX = kingPosX - p.pX;\n                    p.deltaY = kingPosY - p.pY;\n                    p.clickX = kingPosX;\n                    p.clickY = kingPosY;\n                }\n                if (p.legalMove(false, false)) {\n                    p.tempLoad();\n                    return true;\n                }\n                p.tempLoad();\n            }\n        }\n        return false;\n    }\n    public static void checkmate(boolean checkmated, boolean winner) {\n        Piece.checkmated = checkmated;\n        Piece.winner = winner;\n    }\n    public boolean checkmated() {\n        for (Piece p : ps) {\n            if (p.isBlack == isBlackTurn) { // Check moves for the opposite player's pieces (turn has already changed)\n                for (int x = 0; x < 8; x++) {\n                    for (int y = 0; y < 8; y++) {\n                        p.tempSave();\n                        p.deltaX = x - p.pX;\n                        p.deltaY = y - p.pY;\n                        p.clickX = x;\n                        p.clickY = y;\n                        if (p.legalMove(true, false)) {\n                            p.tempLoad();\n                            return false; // At least one legal move is available\n                        }\n                        p.tempLoad();\n                    }\n                }\n            }\n        }\n        return true; // No legal moves available, it's checkmate\n    }\n    public boolean rookMove() {\n        if (!name.equalsIgnoreCase(\"rook\")) return true;\n        return deltaX == 0 || deltaY == 0;\n    } // Rook moves\n    public boolean knightMove() {\n        if (name.equalsIgnoreCase(\"knight\")) {\n            return Math.abs(this.deltaX) == 2 && Math.abs(this.deltaY) == 1 ||\n                    Math.abs(this.deltaX) == 1 && Math.abs(this.deltaY) == 2;\n        }\n        return true;\n    } // Knight moves\n    public boolean bishopMove() {\n        if (!name.equalsIgnoreCase(\"bishop\")) return true;\n        return this.deltaX == deltaY || deltaX == -deltaY;\n    } // Bishop moves\n    public boolean pawnMove() {\n        if (!name.equalsIgnoreCase(\"pawn\")) return true;\n        if (Board.getPiece(clickX * SQR_SIZE, clickY * SQR_SIZE) != null) {\n            if (deltaX < -1 || deltaX > 1) return false; // Diagonal taking\n            if (deltaX == 0) return false; // Can't take non-diagonally\n        } else {\n            if (deltaX != 0) {\n                if (deltaY == 0 || Math.abs(deltaX) > 1) return false; // Can't en passant sideways\n                int signIsBlack = this.isBlack ? -1 : 1;\n                Piece leftPawn = Board.getPiece(clickX * SQR_SIZE,(clickY + signIsBlack) * SQR_SIZE);\n                Piece rightPawn = Board.getPiece(clickX * SQR_SIZE,(clickY + signIsBlack) * SQR_SIZE);\n                if ((leftPawn != null && leftPawn.enPassantEnabled && leftPawn == enPassantPawn) ||\n                        (rightPawn != null && rightPawn.enPassantEnabled && rightPawn == enPassantPawn)) {\n                    enPassantPawn.kill();\n                    return true;\n                }\n                return false; // Can't move to empty square without en passant\n            }\n        }\n        if (!isBlack) { // If piece is white\n            if ((!pieceMoved && deltaY < -2) || (pieceMoved && deltaY < -1)) return false; // Can't move forward far\n            return deltaY < 0; // Can't move backward\n        } else { // If piece is black\n            if ((!pieceMoved && deltaY > 2) || (pieceMoved && deltaY > 1)) return false; // Can't move forward far\n            return deltaY > 0; // Can't move backward\n        }\n    }\n    public boolean boardBoundary() { return clickX <= 7 && clickY <= 7 && clickX >= 0 && clickY >= 0; }\n    public boolean noObstruction() {\n        if (name.equalsIgnoreCase(\"knight\")) return true;\n        int currentX = this.pX + Integer.signum(this.deltaX);\n        int currentY = this.pY + Integer.signum(this.deltaY);\n        while (Math.abs(currentX - clickX) > 0 || Math.abs(currentY - clickY) > 0) {\n            if (Board.getPiece(currentX * SQR_SIZE, currentY * SQR_SIZE) != null) return false;\n            currentX += Integer.signum(this.deltaX);\n            currentY += Integer.signum(this.deltaY);\n        }\n        return true; // No obstruction found\n    }\n    public void tempSave() {\n        this.tempPX = this.pX;\n        this.tempPY = this.pY;\n        this.tempDX = this.deltaX;\n        this.tempDY = this.deltaY;\n        this.tempCX = this.clickX;\n        this.tempCY = this.clickY;\n    }\n    public void tempLoad() {\n        this.pX = this.tempPX;\n        this.pY = this.tempPY;\n        this.deltaX = this.tempDX;\n        this.deltaY = this.tempDY;\n        this.clickX = this.tempCX;\n        this.clickY = this.tempCY;\n    }\n}
+Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+<+>UTF-8
+===================================================================
+diff --git a/src/Piece.java b/src/Piece.java
+--- a/src/Piece.java	(revision f7f4a1687db3927b2782d11a4ff6fa99e39a5065)
++++ b/src/Piece.java	(date 1689670873746)
+@@ -8,7 +8,7 @@
+ public class Piece {
+     static final int SQR_SIZE = Board.SQR_SIZE;
+     int x, y, pX, pY, clickX, clickY, deltaX, deltaY; // Piece values
+-    int tempPX, tempPY, tempDX, tempDY , tempCX, tempCY; // Temporary stored values
++    int tempPX, tempPY, tempDX, tempDY, tempCX, tempCY; // Temporary stored values
+     boolean isBlack;
+     boolean pieceMoved;
+     String name;
+@@ -115,10 +115,7 @@
+             int rookX = (deltaX > 0) ? 7 : 0; // Determine the rook's starting position
+             int rookY = pY; // Rook stays in the same row
+             castleRook = Board.getPiece(rookX * SQR_SIZE, rookY * SQR_SIZE);
+-            Piece bFile = Board.getPiece(SQR_SIZE, pY * SQR_SIZE);
+-            boolean bFilePiece = (bFile != null && deltaX < 0);
+-            if (castleRook != null && castleRook.name.equalsIgnoreCase("rook") && !castleRook.pieceMoved
+-                    && !bFilePiece) {
++            if (castleRook != null && castleRook.name.equalsIgnoreCase("rook") && !castleRook.pieceMoved) {
+                 castling = true;
+                 return true; // Castling successful
+             }
+@@ -127,17 +124,11 @@
+         return Math.abs(deltaX) <= 1 && Math.abs(deltaY) <= 1; // King moves
+     }
+     public boolean resolveCheck() {
+-        this.tempSave();
+-        //Board.selectedPiece.pX = clickX;
+-        //Board.selectedPiece.pY = clickY;
+-        boolean kingInCheck = Board.selectedPiece.myKingInCheck();
++        boolean kingInCheck = myKingInCheck();
+         Piece attack = attacker;
+         Piece attackedPiece = Board.getPiece(clickX * SQR_SIZE, clickY * SQR_SIZE);
+         boolean attackClicked = (attack == attackedPiece);
+-
+-
+         if (kingInCheck) {
+-
+             if (Board.selectedPiece.name.equalsIgnoreCase("king") && isPieceProtected(attacker) &&
+                     attackClicked) {
+                 this.tempLoad();
+@@ -266,8 +257,8 @@
+     } // Rook moves
+     public boolean knightMove() {
+         if (name.equalsIgnoreCase("knight")) {
+-            return Math.abs(this.deltaX) == 2 && Math.abs(this.deltaY) == 1 ||
+-                    Math.abs(this.deltaX) == 1 && Math.abs(this.deltaY) == 2;
++        return Math.abs(this.deltaX) == 2 && Math.abs(this.deltaY) == 1 ||
++                Math.abs(this.deltaX) == 1 && Math.abs(this.deltaY) == 2;
+         }
+         return true;
+     } // Knight moves
+Index: .idea/workspace.xml
+IDEA additional info:
+Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<project version=\"4\">\n  <component name=\"AutoImportSettings\">\n    <option name=\"autoReloadType\" value=\"SELECTIVE\" />\n  </component>\n  <component name=\"ChangeListManager\">\n    <list default=\"true\" id=\"254dee7e-3c0f-48db-b43a-acc0fa3eeb74\" name=\"Changes\" comment=\"king cant take protected pieces fixed\">\n      <change beforePath=\"$PROJECT_DIR$/.idea/workspace.xml\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/.idea/workspace.xml\" afterDir=\"false\" />\n      <change beforePath=\"$PROJECT_DIR$/src/Piece.java\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/src/Piece.java\" afterDir=\"false\" />\n      <change beforePath=\"$PROJECT_DIR$/src/Positions/savePosition\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/src/Positions/savePosition\" afterDir=\"false\" />\n    </list>\n    <option name=\"SHOW_DIALOG\" value=\"false\" />\n    <option name=\"HIGHLIGHT_CONFLICTS\" value=\"true\" />\n    <option name=\"HIGHLIGHT_NON_ACTIVE_CHANGELIST\" value=\"false\" />\n    <option name=\"LAST_RESOLUTION\" value=\"IGNORE\" />\n  </component>\n  <component name=\"FileTemplateManagerImpl\">\n    <option name=\"RECENT_TEMPLATES\">\n      <list>\n        <option value=\"Class\" />\n      </list>\n    </option>\n  </component>\n  <component name=\"Git.Settings\">\n    <option name=\"RECENT_GIT_ROOT_PATH\" value=\"$PROJECT_DIR$\" />\n    <option name=\"RESET_MODE\" value=\"HARD\" />\n  </component>\n  <component name=\"MarkdownSettingsMigration\">\n    <option name=\"stateVersion\" value=\"1\" />\n  </component>\n  <component name=\"ProblemsViewState\">\n    <option name=\"selectedTabId\" value=\"CurrentFile\" />\n  </component>\n  <component name=\"ProjectId\" id=\"2QdXOie2CjeoICbW0CLG0dGsUV3\" />\n  <component name=\"ProjectLevelVcsManager\" settingsEditedManually=\"true\" />\n  <component name=\"ProjectViewState\">\n    <option name=\"hideEmptyMiddlePackages\" value=\"true\" />\n    <option name=\"showLibraryContents\" value=\"true\" />\n  </component>\n  <component name=\"PropertiesComponent\"><![CDATA[{\n  \"keyToString\": {\n    \"RunOnceActivity.OpenProjectViewOnStart\": \"true\",\n    \"RunOnceActivity.ShowReadmeOnStart\": \"true\",\n    \"ToolWindowRun.ShowToolbar\": \"false\",\n    \"run.code.analysis.last.selected.profile\": \"pProject Default\"\n  }\n}]]></component>\n  <component name=\"RecentsManager\">\n    <key name=\"MoveFile.RECENT_KEYS\">\n      <recent name=\"$PROJECT_DIR$/src/Positions\" />\n      <recent name=\"$PROJECT_DIR$/src/Images\" />\n      <recent name=\"$PROJECT_DIR$/src\" />\n    </key>\n  </component>\n  <component name=\"RunManager\">\n    <configuration name=\"Main\" type=\"Application\" factoryName=\"Application\" nameIsGenerated=\"true\">\n      <option name=\"MAIN_CLASS_NAME\" value=\"Main\" />\n      <module name=\"Chess Project\" />\n      <method v=\"2\">\n        <option name=\"Make\" enabled=\"true\" />\n      </method>\n    </configuration>\n  </component>\n  <component name=\"SpellCheckerSettings\" RuntimeDictionaries=\"0\" Folders=\"0\" CustomDictionaries=\"0\" DefaultDictionary=\"application-level\" UseSingleDictionary=\"true\" transferred=\"true\" />\n  <component name=\"TaskManager\">\n    <task active=\"true\" id=\"Default\" summary=\"Default task\">\n      <changelist id=\"254dee7e-3c0f-48db-b43a-acc0fa3eeb74\" name=\"Changes\" comment=\"\" />\n      <created>1685684401255</created>\n      <option name=\"number\" value=\"Default\" />\n      <option name=\"presentableId\" value=\"Default\" />\n      <updated>1685684401255</updated>\n    </task>\n    <task id=\"LOCAL-00028\" summary=\"adding menu bar\">\n      <created>1687221697804</created>\n      <option name=\"number\" value=\"00028\" />\n      <option name=\"presentableId\" value=\"LOCAL-00028\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1687221697804</updated>\n    </task>\n    <task id=\"LOCAL-00029\" summary=\"fixed menu bar\">\n      <created>1687229129023</created>\n      <option name=\"number\" value=\"00029\" />\n      <option name=\"presentableId\" value=\"LOCAL-00029\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1687229129023</updated>\n    </task>\n    <task id=\"LOCAL-00030\" summary=\"deleted original Board class\">\n      <created>1687229448102</created>\n      <option name=\"number\" value=\"00030\" />\n      <option name=\"presentableId\" value=\"LOCAL-00030\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1687229448102</updated>\n    </task>\n    <task id=\"LOCAL-00031\" summary=\"starting save and load classes\">\n      <created>1687319457344</created>\n      <option name=\"number\" value=\"00031\" />\n      <option name=\"presentableId\" value=\"LOCAL-00031\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1687319457344</updated>\n    </task>\n    <task id=\"LOCAL-00032\" summary=\"changed piece taking method\">\n      <created>1687338066000</created>\n      <option name=\"number\" value=\"00032\" />\n      <option name=\"presentableId\" value=\"LOCAL-00032\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1687338066000</updated>\n    </task>\n    <task id=\"LOCAL-00033\" summary=\"king and pawn movements are correct (no en passant and no castling)\">\n      <created>1687434536889</created>\n      <option name=\"number\" value=\"00033\" />\n      <option name=\"presentableId\" value=\"LOCAL-00033\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1687434536889</updated>\n    </task>\n    <task id=\"LOCAL-00034\" summary=\"updated headers for tomorrow\">\n      <created>1687434629968</created>\n      <option name=\"number\" value=\"00034\" />\n      <option name=\"presentableId\" value=\"LOCAL-00034\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1687434629968</updated>\n    </task>\n    <task id=\"LOCAL-00035\" summary=\"rook and bishop move correctly\">\n      <created>1687476406239</created>\n      <option name=\"number\" value=\"00035\" />\n      <option name=\"presentableId\" value=\"LOCAL-00035\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1687476406239</updated>\n    </task>\n    <task id=\"LOCAL-00036\" summary=\"knight moves correctly\">\n      <created>1687477436431</created>\n      <option name=\"number\" value=\"00036\" />\n      <option name=\"presentableId\" value=\"LOCAL-00036\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1687477436431</updated>\n    </task>\n    <task id=\"LOCAL-00037\" summary=\"queen moves correctly\">\n      <created>1687477994965</created>\n      <option name=\"number\" value=\"00037\" />\n      <option name=\"presentableId\" value=\"LOCAL-00037\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1687477994965</updated>\n    </task>\n    <task id=\"LOCAL-00038\" summary=\"turns working correctly\">\n      <created>1687479307881</created>\n      <option name=\"number\" value=\"00038\" />\n      <option name=\"presentableId\" value=\"LOCAL-00038\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1687479307881</updated>\n    </task>\n    <task id=\"LOCAL-00039\" summary=\"castling working\">\n      <created>1687508744090</created>\n      <option name=\"number\" value=\"00039\" />\n      <option name=\"presentableId\" value=\"LOCAL-00039\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1687508744090</updated>\n    </task>\n    <task id=\"LOCAL-00040\" summary=\"all pieces get highlighted\">\n      <created>1687527227520</created>\n      <option name=\"number\" value=\"00040\" />\n      <option name=\"presentableId\" value=\"LOCAL-00040\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1687527227520</updated>\n    </task>\n    <task id=\"LOCAL-00041\" summary=\"pieces get highlighted on their turn\">\n      <created>1687528613518</created>\n      <option name=\"number\" value=\"00041\" />\n      <option name=\"presentableId\" value=\"LOCAL-00041\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1687528613518</updated>\n    </task>\n    <task id=\"LOCAL-00042\" summary=\"fixed castling double move\">\n      <created>1687530853336</created>\n      <option name=\"number\" value=\"00042\" />\n      <option name=\"presentableId\" value=\"LOCAL-00042\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1687530853336</updated>\n    </task>\n    <task id=\"LOCAL-00043\" summary=\"code shortening and updated headers\">\n      <created>1687772300334</created>\n      <option name=\"number\" value=\"00043\" />\n      <option name=\"presentableId\" value=\"LOCAL-00043\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1687772300334</updated>\n    </task>\n    <task id=\"LOCAL-00044\" summary=\"king check and updated headers\">\n      <created>1687922195238</created>\n      <option name=\"number\" value=\"00044\" />\n      <option name=\"presentableId\" value=\"LOCAL-00044\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1687922195238</updated>\n    </task>\n    <task id=\"LOCAL-00045\" summary=\"king check second iteration and updated headers\">\n      <created>1687987552301</created>\n      <option name=\"number\" value=\"00045\" />\n      <option name=\"presentableId\" value=\"LOCAL-00045\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1687987552301</updated>\n    </task>\n    <task id=\"LOCAL-00046\" summary=\"king check fourth iteration (progress!)\">\n      <created>1689224928387</created>\n      <option name=\"number\" value=\"00046\" />\n      <option name=\"presentableId\" value=\"LOCAL-00046\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689224928387</updated>\n    </task>\n    <task id=\"LOCAL-00047\" summary=\"king check (super slow loop)\">\n      <created>1689227571289</created>\n      <option name=\"number\" value=\"00047\" />\n      <option name=\"presentableId\" value=\"LOCAL-00047\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689227571289</updated>\n    </task>\n    <task id=\"LOCAL-00048\" summary=\"king check (another slow loop)\">\n      <created>1689230016677</created>\n      <option name=\"number\" value=\"00048\" />\n      <option name=\"presentableId\" value=\"LOCAL-00048\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689230016677</updated>\n    </task>\n    <task id=\"LOCAL-00049\" summary=\"noObstruction changed: Bresenham's line algorithm\">\n      <created>1689231879282</created>\n      <option name=\"number\" value=\"00049\" />\n      <option name=\"presentableId\" value=\"LOCAL-00049\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689231879282</updated>\n    </task>\n    <task id=\"LOCAL-00050\" summary=\"added diagonal to Bresenham's line algorithm\">\n      <created>1689232631865</created>\n      <option name=\"number\" value=\"00050\" />\n      <option name=\"presentableId\" value=\"LOCAL-00050\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689232631867</updated>\n    </task>\n    <task id=\"LOCAL-00051\" summary=\"noObstruction working\">\n      <created>1689239679673</created>\n      <option name=\"number\" value=\"00051\" />\n      <option name=\"presentableId\" value=\"LOCAL-00051\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689239679673</updated>\n    </task>\n    <task id=\"LOCAL-00052\" summary=\"noObstruction working (again)\">\n      <created>1689240974086</created>\n      <option name=\"number\" value=\"00052\" />\n      <option name=\"presentableId\" value=\"LOCAL-00052\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689240974086</updated>\n    </task>\n    <task id=\"LOCAL-00053\" summary=\"noObstruction working added err math.\">\n      <created>1689241012581</created>\n      <option name=\"number\" value=\"00053\" />\n      <option name=\"presentableId\" value=\"LOCAL-00053\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689241012582</updated>\n    </task>\n    <task id=\"LOCAL-00054\" summary=\"noObstruction changed to have more this.* code\">\n      <created>1689243435879</created>\n      <option name=\"number\" value=\"00054\" />\n      <option name=\"presentableId\" value=\"LOCAL-00054\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689243435879</updated>\n    </task>\n    <task id=\"LOCAL-00055\" summary=\"fixed kingCheck and noObstruction\">\n      <created>1689244242664</created>\n      <option name=\"number\" value=\"00055\" />\n      <option name=\"presentableId\" value=\"LOCAL-00055\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689244242664</updated>\n    </task>\n    <task id=\"LOCAL-00056\" summary=\"check works for own pieces\">\n      <created>1689308889837</created>\n      <option name=\"number\" value=\"00056\" />\n      <option name=\"presentableId\" value=\"LOCAL-00056\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689308889837</updated>\n    </task>\n    <task id=\"LOCAL-00057\" summary=\"separated check into multiple methods\">\n      <created>1689312676150</created>\n      <option name=\"number\" value=\"00057\" />\n      <option name=\"presentableId\" value=\"LOCAL-00057\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689312676150</updated>\n    </task>\n    <task id=\"LOCAL-00058\" summary=\"separated check into multiple methods\">\n      <created>1689312825465</created>\n      <option name=\"number\" value=\"00058\" />\n      <option name=\"presentableId\" value=\"LOCAL-00058\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689312825465</updated>\n    </task>\n    <task id=\"LOCAL-00059\" summary=\"can escape check\">\n      <created>1689316849748</created>\n      <option name=\"number\" value=\"00059\" />\n      <option name=\"presentableId\" value=\"LOCAL-00059\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689316849748</updated>\n    </task>\n    <task id=\"LOCAL-00060\" summary=\"adding checkmate\">\n      <created>1689318016931</created>\n      <option name=\"number\" value=\"00060\" />\n      <option name=\"presentableId\" value=\"LOCAL-00060\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689318016932</updated>\n    </task>\n    <task id=\"LOCAL-00061\" summary=\"fixed check so pieces can be taken\">\n      <created>1689319709897</created>\n      <option name=\"number\" value=\"00061\" />\n      <option name=\"presentableId\" value=\"LOCAL-00061\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689319709897</updated>\n    </task>\n    <task id=\"LOCAL-00062\" summary=\"bishop breaks game during fools mate\">\n      <created>1689320003374</created>\n      <option name=\"number\" value=\"00062\" />\n      <option name=\"presentableId\" value=\"LOCAL-00062\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689320003374</updated>\n    </task>\n    <task id=\"LOCAL-00063\" summary=\"checkmate works\">\n      <created>1689419945633</created>\n      <option name=\"number\" value=\"00063\" />\n      <option name=\"presentableId\" value=\"LOCAL-00063\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689419945633</updated>\n    </task>\n    <task id=\"LOCAL-00064\" summary=\"checkmate message\">\n      <created>1689423774844</created>\n      <option name=\"number\" value=\"00064\" />\n      <option name=\"presentableId\" value=\"LOCAL-00064\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689423774844</updated>\n    </task>\n    <task id=\"LOCAL-00065\" summary=\"cant take non attacking piece in check\">\n      <created>1689432126155</created>\n      <option name=\"number\" value=\"00065\" />\n      <option name=\"presentableId\" value=\"LOCAL-00065\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689432126155</updated>\n    </task>\n    <task id=\"LOCAL-00066\" summary=\"added en passant\">\n      <created>1689438968472</created>\n      <option name=\"number\" value=\"00066\" />\n      <option name=\"presentableId\" value=\"LOCAL-00066\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689438968472</updated>\n    </task>\n    <task id=\"LOCAL-00067\" summary=\"updated headers\">\n      <created>1689440458490</created>\n      <option name=\"number\" value=\"00067\" />\n      <option name=\"presentableId\" value=\"LOCAL-00067\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689440458490</updated>\n    </task>\n    <task id=\"LOCAL-00068\" summary=\"load pieces from text file\">\n      <created>1689481303454</created>\n      <option name=\"number\" value=\"00068\" />\n      <option name=\"presentableId\" value=\"LOCAL-00068\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689481303454</updated>\n    </task>\n    <task id=\"LOCAL-00069\" summary=\"save pieces to text file\">\n      <created>1689482089542</created>\n      <option name=\"number\" value=\"00069\" />\n      <option name=\"presentableId\" value=\"LOCAL-00069\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689482089542</updated>\n    </task>\n    <task id=\"LOCAL-00070\" summary=\"save and load working\">\n      <created>1689483886522</created>\n      <option name=\"number\" value=\"00070\" />\n      <option name=\"presentableId\" value=\"LOCAL-00070\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689483886522</updated>\n    </task>\n    <task id=\"LOCAL-00071\" summary=\"save and load fully implemented\">\n      <created>1689489148092</created>\n      <option name=\"number\" value=\"00071\" />\n      <option name=\"presentableId\" value=\"LOCAL-00071\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689489148092</updated>\n    </task>\n    <task id=\"LOCAL-00072\" summary=\"fixed castling\">\n      <created>1689489904670</created>\n      <option name=\"number\" value=\"00072\" />\n      <option name=\"presentableId\" value=\"LOCAL-00072\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689489904670</updated>\n    </task>\n    <task id=\"LOCAL-00073\" summary=\"fixed castling and checkmate\">\n      <created>1689498317226</created>\n      <option name=\"number\" value=\"00073\" />\n      <option name=\"presentableId\" value=\"LOCAL-00073\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689498317227</updated>\n    </task>\n    <task id=\"LOCAL-00074\" summary=\"fixing king cant take protected pieces\">\n      <created>1689655436130</created>\n      <option name=\"number\" value=\"00074\" />\n      <option name=\"presentableId\" value=\"LOCAL-00074\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689655436131</updated>\n    </task>\n    <task id=\"LOCAL-00075\" summary=\"king cant take protected pieces\">\n      <created>1689656522651</created>\n      <option name=\"number\" value=\"00075\" />\n      <option name=\"presentableId\" value=\"LOCAL-00075\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689656522651</updated>\n    </task>\n    <task id=\"LOCAL-00076\" summary=\"king cant take protected pieces fixed\">\n      <created>1689657348499</created>\n      <option name=\"number\" value=\"00076\" />\n      <option name=\"presentableId\" value=\"LOCAL-00076\" />\n      <option name=\"project\" value=\"LOCAL\" />\n      <updated>1689657348499</updated>\n    </task>\n    <option name=\"localTasksCounter\" value=\"77\" />\n    <servers />\n  </component>\n  <component name=\"Vcs.Log.Tabs.Properties\">\n    <option name=\"TAB_STATES\">\n      <map>\n        <entry key=\"MAIN\">\n          <value>\n            <State />\n          </value>\n        </entry>\n      </map>\n    </option>\n  </component>\n  <component name=\"VcsManagerConfiguration\">\n    <MESSAGE value=\"noObstruction working (again)\" />\n    <MESSAGE value=\"noObstruction working added err math.\" />\n    <MESSAGE value=\"noObstruction changed to have more this.* code\" />\n    <MESSAGE value=\"fixed kingCheck and noObstruction\" />\n    <MESSAGE value=\"check works for own pieces\" />\n    <MESSAGE value=\"separated check into multiple methods\" />\n    <MESSAGE value=\"can escape check\" />\n    <MESSAGE value=\"adding checkmate\" />\n    <MESSAGE value=\"fixed check so pieces can be taken\" />\n    <MESSAGE value=\"bishop breaks game during fools mate\" />\n    <MESSAGE value=\"check works\" />\n    <MESSAGE value=\"checkmate works\" />\n    <MESSAGE value=\"checkmate message\" />\n    <MESSAGE value=\"cant take non attacking piece in check\" />\n    <MESSAGE value=\"added en passant\" />\n    <MESSAGE value=\"updated headers\" />\n    <MESSAGE value=\"load pieces from text file\" />\n    <MESSAGE value=\"save pieces to text file\" />\n    <MESSAGE value=\"save and load working\" />\n    <MESSAGE value=\"save and load fully implemented\" />\n    <MESSAGE value=\"fixed castling\" />\n    <MESSAGE value=\"fixed castling and checkmate\" />\n    <MESSAGE value=\"fixing king cant take protected pieces\" />\n    <MESSAGE value=\"king cant take protected pieces\" />\n    <MESSAGE value=\"king cant take protected pieces fixed\" />\n    <option name=\"LAST_COMMIT_MESSAGE\" value=\"king cant take protected pieces fixed\" />\n  </component>\n</project>
+Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+<+>UTF-8
+===================================================================
+diff --git a/.idea/workspace.xml b/.idea/workspace.xml
+--- a/.idea/workspace.xml	(revision f7f4a1687db3927b2782d11a4ff6fa99e39a5065)
++++ b/.idea/workspace.xml	(date 1689670006928)
+@@ -4,10 +4,11 @@
+     <option name="autoReloadType" value="SELECTIVE" />
+   </component>
+   <component name="ChangeListManager">
+-    <list default="true" id="254dee7e-3c0f-48db-b43a-acc0fa3eeb74" name="Changes" comment="king cant take protected pieces fixed">
++    <list default="true" id="ef8981d4-d1d8-40b2-bd70-fa1fd0358079" name="Changes" comment="fixed castling">
+       <change beforePath="$PROJECT_DIR$/.idea/workspace.xml" beforeDir="false" afterPath="$PROJECT_DIR$/.idea/workspace.xml" afterDir="false" />
+       <change beforePath="$PROJECT_DIR$/src/Piece.java" beforeDir="false" afterPath="$PROJECT_DIR$/src/Piece.java" afterDir="false" />
+       <change beforePath="$PROJECT_DIR$/src/Positions/savePosition" beforeDir="false" afterPath="$PROJECT_DIR$/src/Positions/savePosition" afterDir="false" />
++      <change beforePath="$PROJECT_DIR$/src/Positions/saveTurn" beforeDir="false" afterPath="$PROJECT_DIR$/src/Positions/saveTurn" afterDir="false" />
+     </list>
+     <option name="SHOW_DIALOG" value="false" />
+     <option name="HIGHLIGHT_CONFLICTS" value="true" />
+@@ -37,14 +38,14 @@
+     <option name="hideEmptyMiddlePackages" value="true" />
+     <option name="showLibraryContents" value="true" />
+   </component>
+-  <component name="PropertiesComponent"><![CDATA[{
+-  "keyToString": {
+-    "RunOnceActivity.OpenProjectViewOnStart": "true",
+-    "RunOnceActivity.ShowReadmeOnStart": "true",
+-    "ToolWindowRun.ShowToolbar": "false",
+-    "run.code.analysis.last.selected.profile": "pProject Default"
++  <component name="PropertiesComponent">{
++  &quot;keyToString&quot;: {
++    &quot;RunOnceActivity.OpenProjectViewOnStart&quot;: &quot;true&quot;,
++    &quot;RunOnceActivity.ShowReadmeOnStart&quot;: &quot;true&quot;,
++    &quot;ToolWindowRun.ShowToolbar&quot;: &quot;false&quot;,
++    &quot;run.code.analysis.last.selected.profile&quot;: &quot;pProject Default&quot;
+   }
+-}]]></component>
++}</component>
+   <component name="RecentsManager">
+     <key name="MoveFile.RECENT_KEYS">
+       <recent name="$PROJECT_DIR$/src/Positions" />
+@@ -69,13 +70,6 @@
+       <option name="number" value="Default" />
+       <option name="presentableId" value="Default" />
+       <updated>1685684401255</updated>
+-    </task>
+-    <task id="LOCAL-00028" summary="adding menu bar">
+-      <created>1687221697804</created>
+-      <option name="number" value="00028" />
+-      <option name="presentableId" value="LOCAL-00028" />
+-      <option name="project" value="LOCAL" />
+-      <updated>1687221697804</updated>
+     </task>
+     <task id="LOCAL-00029" summary="fixed menu bar">
+       <created>1687229129023</created>
+@@ -413,7 +407,14 @@
+       <option name="project" value="LOCAL" />
+       <updated>1689657348499</updated>
+     </task>
+-    <option name="localTasksCounter" value="77" />
++    <task id="LOCAL-00077" summary="fixed castling">
++      <created>1689669684375</created>
++      <option name="number" value="00077" />
++      <option name="presentableId" value="LOCAL-00077" />
++      <option name="project" value="LOCAL" />
++      <updated>1689669684375</updated>
++    </task>
++    <option name="localTasksCounter" value="78" />
+     <servers />
+   </component>
+   <component name="Vcs.Log.Tabs.Properties">
+@@ -448,11 +449,11 @@
+     <MESSAGE value="save pieces to text file" />
+     <MESSAGE value="save and load working" />
+     <MESSAGE value="save and load fully implemented" />
+-    <MESSAGE value="fixed castling" />
+     <MESSAGE value="fixed castling and checkmate" />
+     <MESSAGE value="fixing king cant take protected pieces" />
+     <MESSAGE value="king cant take protected pieces" />
+     <MESSAGE value="king cant take protected pieces fixed" />
+-    <option name="LAST_COMMIT_MESSAGE" value="king cant take protected pieces fixed" />
++    <MESSAGE value="fixed castling" />
++    <option name="LAST_COMMIT_MESSAGE" value="fixed castling" />
+   </component>
+ </project>
+\ No newline at end of file
+Index: src/Positions/savePosition
+IDEA additional info:
+Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
+<+>7,3,false,true,queen\n4,7,false,false,king\n0,7,false,false,rook\n7,7,false,false,rook\n2,7,false,false,bishop\n2,4,false,true,bishop\n1,7,false,false,knight\n6,7,false,false,knight\n0,5,false,true,pawn\n1,6,false,false,pawn\n2,6,false,false,pawn\n3,6,false,false,pawn\n4,5,false,true,pawn\n5,6,false,false,pawn\n6,6,false,false,pawn\n7,5,false,true,pawn\n2,0,true,true,queen\n4,0,true,false,king\n0,0,true,false,rook\n7,0,true,false,rook\n1,1,true,true,bishop\n5,0,true,false,bishop\n1,0,true,false,knight\n6,0,true,false,knight\n0,2,true,true,pawn\n1,2,true,true,pawn\n2,1,true,false,pawn\n3,2,true,true,pawn\n4,1,true,false,pawn\n5,1,true,false,pawn\n6,1,true,false,pawn\n7,1,true,false,pawn\n
+Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
+<+>UTF-8
+===================================================================
+diff --git a/src/Positions/savePosition b/src/Positions/savePosition
+--- a/src/Positions/savePosition	(revision f7f4a1687db3927b2782d11a4ff6fa99e39a5065)
++++ b/src/Positions/savePosition	(date 1689669950681)
+@@ -1,31 +1,31 @@
+-7,3,false,true,queen
++6,2,false,true,queen
+ 4,7,false,false,king
+ 0,7,false,false,rook
+ 7,7,false,false,rook
+ 2,7,false,false,bishop
+-2,4,false,true,bishop
++2,4,false,false,bishop
+ 1,7,false,false,knight
+ 6,7,false,false,knight
+-0,5,false,true,pawn
++0,5,false,false,pawn
+ 1,6,false,false,pawn
+ 2,6,false,false,pawn
+ 3,6,false,false,pawn
+-4,5,false,true,pawn
++4,5,false,false,pawn
+ 5,6,false,false,pawn
+ 6,6,false,false,pawn
+-7,5,false,true,pawn
+-2,0,true,true,queen
++7,5,false,false,pawn
++2,0,true,false,queen
+ 4,0,true,false,king
+ 0,0,true,false,rook
+ 7,0,true,false,rook
+-1,1,true,true,bishop
++1,1,true,false,bishop
+ 5,0,true,false,bishop
+ 1,0,true,false,knight
+ 6,0,true,false,knight
+-0,2,true,true,pawn
+-1,2,true,true,pawn
++0,2,true,false,pawn
++1,2,true,false,pawn
+ 2,1,true,false,pawn
+-3,2,true,true,pawn
++3,2,true,false,pawn
+ 4,1,true,false,pawn
+ 5,1,true,false,pawn
+ 6,1,true,false,pawn
Index: .idea/shelf/Uncommitted_changes_before_Checkout_at_18_07_23__9_02_pm__Changes_.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/shelf/Uncommitted_changes_before_Checkout_at_18_07_23__9_02_pm__Changes_.xml b/.idea/shelf/Uncommitted_changes_before_Checkout_at_18_07_23__9_02_pm__Changes_.xml
new file mode 100644
--- /dev/null	(date 1689671327366)
+++ b/.idea/shelf/Uncommitted_changes_before_Checkout_at_18_07_23__9_02_pm__Changes_.xml	(date 1689671327366)
@@ -0,0 +1,4 @@
+<changelist name="Uncommitted_changes_before_Checkout_at_18_07_23,_9_02_pm_[Changes]" date="1689671322454" recycled="true" deleted="true">
+  <option name="PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Checkout_at_18_07_23,_9_02_pm_[Changes]/shelved.patch" />
+  <option name="DESCRIPTION" value="Uncommitted changes before Checkout at 18/07/23, 9:02 pm [Changes]" />
+</changelist>
\ No newline at end of file
Index: src/Piece.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>/**\n * Constructor for all chess pieces\n *\n * @author (Piper Inns Hall)\n * @version (16/07/2023)\n */\nimport java.util.LinkedList;\npublic class Piece {\n    static final int SQR_SIZE = Board.SQR_SIZE;\n    int x, y, pX, pY, clickX, clickY, deltaX, deltaY; // Piece values\n    int tempPX, tempPY, tempDX, tempDY , tempCX, tempCY; // Temporary stored values\n    boolean isBlack;\n    boolean pieceMoved;\n    String name;\n    LinkedList<Piece> ps;\n    boolean castling;\n    boolean enPassantEnabled;\n    private static boolean isBlackTurn;\n    public static boolean checkmated;\n    public static boolean winner;\n    public static Piece enPassantPawn;\n    Piece castleRook;\n    Piece attacker;\n    public Piece(int pX, int pY, boolean isBlack, boolean pieceMoved, String n, LinkedList<Piece> ps) {\n        this.x = pX * SQR_SIZE;\n        this.y = pY * SQR_SIZE;\n        this.pX = pX;\n        this.pY = pY;\n        this.isBlack = isBlack;\n        this.pieceMoved = pieceMoved;\n        this.ps = ps;\n        this.name = n;\n        ps.add(this);\n    }\n    public void move(int pX, int pY) {\n        deltaX = pX - this.pX;\n        deltaY = pY - this.pY;\n        clickX = pX;\n        clickY = pY;\n        boolean checking = oppositeKingInCheck();\n        if (legalMove(true, false)) {\n            moveType();\n            this.pieceMoved = true;\n            this.pX = pX;\n            this.pY = pY;\n            this.x = pX * SQR_SIZE;\n            this.y = pY * SQR_SIZE;\n            switchTurn();\n            if (checking) checkmate(checkmated(), this.isBlack);\n        }\n    }\n\n    public static void switchTurn() { isBlackTurn = !isBlackTurn; } // Switching turns\n    public static void resetTurn() { isBlackTurn = false; } // Reset turns\n    public static void loadTurn(boolean blackTurn) { isBlackTurn = blackTurn; } // Loads turns\n    public static boolean saveTurn() { return isBlackTurn; } // Saves turns\n    public void moveType() {\n        pieceTake();\n        pawnPromote();\n        pawnDouble();\n        if (this.castling) castle();\n    }\n    public void pieceTake() {\n        Piece take = Board.getPiece(clickX * SQR_SIZE, clickY * SQR_SIZE);\n        if (take != null) take.kill(); // Taking pieces\n    }\n    public void kill() {\n        if (enPassantPawn == this) enPassantPawn = null; // Reset en passant pawn if it is killed\n        ps.remove(this);\n    }\n    public void pawnPromote() {\n        if (name.equalsIgnoreCase(\"pawn\"))\n            if ((this.isBlack && clickY == 7) || (!this.isBlack && clickY == 0)) name = \"queen\"; // Promoting pawns\n    }\n    public void pawnDouble() {\n        enPassantPawn = null;\n        if (name.equalsIgnoreCase(\"pawn\") && Math.abs(deltaY) == 2) {\n            enPassantEnabled = true;\n            enPassantPawn = this;\n        }\n    }\n    public void castle() {\n        castleRook.pX = (deltaX > 0) ? this.pX + 1 : this.pX - 1;\n        castleRook.x = castleRook.pX * SQR_SIZE;\n        castleRook.y = castleRook.pY * SQR_SIZE;\n        castling = false;\n    }\n    public boolean legalMove(boolean realMove, boolean resolveCheck) {\n        if (realMove && !checkTurn()) return false;\n        if (ownSQRMove()) return false;\n        if (!resolveCheck && ownPieceMove()) return false;\n        if (!queenMove()) return false;\n        if (!kingMove()) return false;\n        if (realMove && !resolveCheck()) return false;\n        if (!rookMove()) return false;\n        if (!knightMove()) return false;\n        if (!bishopMove()) return false;\n        if (!pawnMove()) return false;\n        if (!boardBoundary()) return false;\n        return noObstruction();\n    }\n    public boolean checkTurn() { return (isBlackTurn && this.isBlack) || (!isBlackTurn && !this.isBlack); }\n    public boolean ownSQRMove() { return this.deltaX == 0 && this.deltaY == 0; } // Cannot move to own SQR\n    public boolean ownPieceMove() {\n        Piece clickedPiece = Board.getPiece(clickX * SQR_SIZE, clickY * SQR_SIZE);\n        return clickedPiece != null && clickedPiece.isBlack == isBlack; // Cannot take own pieces\n    }\n    public boolean queenMove() {\n        if (!name.equalsIgnoreCase(\"queen\")) return true;\n        return Math.abs(this.deltaX) == Math.abs(this.deltaY) || deltaX == 0 || deltaY == 0;\n    } // Queen moves\n    public boolean kingMove() {\n        if (!name.equalsIgnoreCase(\"king\")) return true;\n        if (!pieceMoved && deltaY == 0 && Math.abs(deltaX) == 2) {\n            int rookX = (deltaX > 0) ? 7 : 0; // Determine the rook's starting position\n            int rookY = pY; // Rook stays in the same row\n            castleRook = Board.getPiece(rookX * SQR_SIZE, rookY * SQR_SIZE);\n            if (castleRook != null && castleRook.name.equalsIgnoreCase(\"rook\") && !castleRook.pieceMoved) {\n                castling = true;\n                return true; // Castling successful\n            }\n            return false; // Castling is not valid\n        }\n        return Math.abs(deltaX) <= 1 && Math.abs(deltaY) <= 1; // King moves\n    }\n    public boolean resolveCheck() {\n        boolean kingInCheck = myKingInCheck();\n        Piece attack = attacker;\n        Piece attackedPiece = Board.getPiece(clickX * SQR_SIZE, clickY * SQR_SIZE);\n        boolean attackClicked = (attack == attackedPiece);\n        if (kingInCheck) {\n            if (Board.selectedPiece.name.equalsIgnoreCase(\"king\") && isPieceProtected(attacker) &&\n                    attackClicked) {\n                this.tempLoad();\n                return false; // King cannot take protected piece\n            }\n            else if (!Board.selectedPiece.name.equalsIgnoreCase(\"king\") && !attackClicked) {\n                this.tempLoad();\n                return false; // King cannot escape check\n            }\n        }\n        this.tempLoad();\n        return true; // King can escape check with this move\n    }\n    public boolean myKingInCheck() {\n        Piece myKing = myKingPos();\n        return check(myKing, myKing.pX, myKing.pY);\n    }\n    public boolean oppositeKingInCheck() {\n        Piece oppositeKing = oppositeKingPos();\n        return checking(oppositeKing, oppositeKing.pX, oppositeKing.pY);\n    }\n    public Piece myKingPos() {\n        for (Piece p : ps) {\n            if (p.name.equalsIgnoreCase(\"king\") && p.isBlack == this.isBlack) {\n                return p;\n            }\n        }\n        return null; // Return null if the king is not found\n    }\n    public Piece oppositeKingPos() {\n        for (Piece p : ps) {\n            if (p.name.equalsIgnoreCase(\"king\") && p.isBlack != this.isBlack) {\n                return p;\n            }\n        }\n        return null; // Return null if the king is not found\n    }\n    private boolean isPieceProtected(Piece attacker) {\n        for (Piece p : ps) {\n            if (p.isBlack != isBlackTurn) {\n                p.tempSave();\n                p.deltaX = attacker.pX - p.pX;\n                p.deltaY = attacker.pY - p.pY;\n                p.clickX = attacker.pX;\n                p.clickY = attacker.pY;\n                if (p.legalMove(false, true)) {\n                    p.tempLoad();\n                    return true; // Piece is protected\n                }\n                p.tempLoad();\n            }\n        }\n        return false; // Piece is not protected\n    }\n    public boolean check(Piece myKing, int kingPosX, int kingPosY) {\n        for (Piece p : ps) {\n            if (p.isBlack != isBlackTurn) {\n                p.tempSave();\n                if (myKing != null) {\n                    p.deltaX = kingPosX - p.pX;\n                    p.deltaY = kingPosY - p.pY;\n                    p.clickX = kingPosX;\n                    p.clickY = kingPosY;\n                }\n                if (p.legalMove(false, false)) {\n                    attacker = p;\n                    p.tempLoad();\n                    return true;\n                }\n                p.tempLoad();\n            }\n        }\n        return false;\n    }\n    public boolean checking(Piece oppositeKing, int kingPosX, int kingPosY) {\n        for (Piece p : ps) {\n            if (p.isBlack == isBlackTurn) {\n                p.tempSave();\n                if (p == Board.selectedPiece) {\n                    p.pX = Board.selectedPiece.clickX;\n                    p.pY = Board.selectedPiece.clickY;\n                }\n                if (oppositeKing != null) {\n                    p.deltaX = kingPosX - p.pX;\n                    p.deltaY = kingPosY - p.pY;\n                    p.clickX = kingPosX;\n                    p.clickY = kingPosY;\n                }\n                if (p.legalMove(false, false)) {\n                    p.tempLoad();\n                    return true;\n                }\n                p.tempLoad();\n            }\n        }\n        return false;\n    }\n    public static void checkmate(boolean checkmated, boolean winner) {\n        Piece.checkmated = checkmated;\n        Piece.winner = winner;\n    }\n    public boolean checkmated() {\n        for (Piece p : ps) {\n            if (p.isBlack == isBlackTurn) { // Check moves for the opposite player's pieces (turn has already changed)\n                for (int x = 0; x < 8; x++) {\n                    for (int y = 0; y < 8; y++) {\n                        p.tempSave();\n                        p.deltaX = x - p.pX;\n                        p.deltaY = y - p.pY;\n                        p.clickX = x;\n                        p.clickY = y;\n                        if (p.legalMove(true, false)) {\n                            p.tempLoad();\n                            return false; // At least one legal move is available\n                        }\n                        p.tempLoad();\n                    }\n                }\n            }\n        }\n        return true; // No legal moves available, it's checkmate\n    }\n    public boolean rookMove() {\n        if (!name.equalsIgnoreCase(\"rook\")) return true;\n        return deltaX == 0 || deltaY == 0;\n    } // Rook moves\n    public boolean knightMove() {\n        if (name.equalsIgnoreCase(\"knight\")) {\n        return Math.abs(this.deltaX) == 2 && Math.abs(this.deltaY) == 1 ||\n                Math.abs(this.deltaX) == 1 && Math.abs(this.deltaY) == 2;\n        }\n        return true;\n    } // Knight moves\n    public boolean bishopMove() {\n        if (!name.equalsIgnoreCase(\"bishop\")) return true;\n        return this.deltaX == deltaY || deltaX == -deltaY;\n    } // Bishop moves\n    public boolean pawnMove() {\n        if (!name.equalsIgnoreCase(\"pawn\")) return true;\n        if (Board.getPiece(clickX * SQR_SIZE, clickY * SQR_SIZE) != null) {\n            if (deltaX < -1 || deltaX > 1) return false; // Diagonal taking\n            if (deltaX == 0) return false; // Can't take non-diagonally\n        } else {\n            if (deltaX != 0) {\n                if (deltaY == 0 || Math.abs(deltaX) > 1) return false; // Can't en passant sideways\n                int signIsBlack = this.isBlack ? -1 : 1;\n                Piece leftPawn = Board.getPiece(clickX * SQR_SIZE,(clickY + signIsBlack) * SQR_SIZE);\n                Piece rightPawn = Board.getPiece(clickX * SQR_SIZE,(clickY + signIsBlack) * SQR_SIZE);\n                if ((leftPawn != null && leftPawn.enPassantEnabled && leftPawn == enPassantPawn) ||\n                        (rightPawn != null && rightPawn.enPassantEnabled && rightPawn == enPassantPawn)) {\n                    enPassantPawn.kill();\n                    return true;\n                }\n                return false; // Can't move to empty square without en passant\n            }\n        }\n        if (!isBlack) { // If piece is white\n            if ((!pieceMoved && deltaY < -2) || (pieceMoved && deltaY < -1)) return false; // Can't move forward far\n            return deltaY < 0; // Can't move backward\n        } else { // If piece is black\n            if ((!pieceMoved && deltaY > 2) || (pieceMoved && deltaY > 1)) return false; // Can't move forward far\n            return deltaY > 0; // Can't move backward\n        }\n    }\n    public boolean boardBoundary() { return clickX <= 7 && clickY <= 7 && clickX >= 0 && clickY >= 0; }\n    public boolean noObstruction() {\n        if (name.equalsIgnoreCase(\"knight\")) return true;\n        int currentX = this.pX + Integer.signum(this.deltaX);\n        int currentY = this.pY + Integer.signum(this.deltaY);\n        while (Math.abs(currentX - clickX) > 0 || Math.abs(currentY - clickY) > 0) {\n            if (Board.getPiece(currentX * SQR_SIZE, currentY * SQR_SIZE) != null) return false;\n            currentX += Integer.signum(this.deltaX);\n            currentY += Integer.signum(this.deltaY);\n        }\n        return true; // No obstruction found\n    }\n    public void tempSave() {\n        this.tempPX = this.pX;\n        this.tempPY = this.pY;\n        this.tempDX = this.deltaX;\n        this.tempDY = this.deltaY;\n        this.tempCX = this.clickX;\n        this.tempCY = this.clickY;\n    }\n    public void tempLoad() {\n        this.pX = this.tempPX;\n        this.pY = this.tempPY;\n        this.deltaX = this.tempDX;\n        this.deltaY = this.tempDY;\n        this.clickX = this.tempCX;\n        this.clickY = this.tempCY;\n    }\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/Piece.java b/src/Piece.java
--- a/src/Piece.java	(revision 5035bca32b467a960ede4eff8c06ebc3c3a93d2b)
+++ b/src/Piece.java	(date 1689671230472)
@@ -8,7 +8,7 @@
 public class Piece {
     static final int SQR_SIZE = Board.SQR_SIZE;
     int x, y, pX, pY, clickX, clickY, deltaX, deltaY; // Piece values
-    int tempPX, tempPY, tempDX, tempDY , tempCX, tempCY; // Temporary stored values
+    int tempPX, tempPY, tempDX, tempDY, tempCX, tempCY; // Temporary stored values
     boolean isBlack;
     boolean pieceMoved;
     String name;
@@ -115,7 +115,10 @@
             int rookX = (deltaX > 0) ? 7 : 0; // Determine the rook's starting position
             int rookY = pY; // Rook stays in the same row
             castleRook = Board.getPiece(rookX * SQR_SIZE, rookY * SQR_SIZE);
-            if (castleRook != null && castleRook.name.equalsIgnoreCase("rook") && !castleRook.pieceMoved) {
+            Piece bFile = Board.getPiece(SQR_SIZE, pY * SQR_SIZE);
+            boolean bFilePiece = (bFile != null && deltaX < 0);
+            if (castleRook != null && castleRook.name.equalsIgnoreCase("rook") && !castleRook.pieceMoved
+                    && !bFilePiece) {
                 castling = true;
                 return true; // Castling successful
             }
@@ -257,8 +260,8 @@
     } // Rook moves
     public boolean knightMove() {
         if (name.equalsIgnoreCase("knight")) {
-        return Math.abs(this.deltaX) == 2 && Math.abs(this.deltaY) == 1 ||
-                Math.abs(this.deltaX) == 1 && Math.abs(this.deltaY) == 2;
+            return Math.abs(this.deltaX) == 2 && Math.abs(this.deltaY) == 1 ||
+                    Math.abs(this.deltaX) == 1 && Math.abs(this.deltaY) == 2;
         }
         return true;
     } // Knight moves
